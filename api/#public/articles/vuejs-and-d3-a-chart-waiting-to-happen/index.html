<!doctype html>
<html data-n-head-ssr lang="en" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Vue.js and D3: A Chart Waiting To Happen - Simon Wuyts</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" property="og:type" content="website"><meta data-n-head="ssr" property="twitter:card" content="summary_large_image"><meta data-n-head="ssr" data-hid="description" name="description" content="<p>This article is the summary of a talk I gave at the Vue.js Antwerp meetup. For a while now, D3.js has been the go-to JavaScript library for creating custom data visualizations. However, it&amp;rsquo;s sometimes perceived as difficult to get started with or unsuitable for small projects. In this article I will show you how combining D3 and Vue can make your quest for the perfect data visualization a whole lot easier.</p>"><meta data-n-head="ssr" data-hid="ogdescription" property="og:description" content="<p>This article is the summary of a talk I gave at the Vue.js Antwerp meetup. For a while now, D3.js has been the go-to JavaScript library for creating custom data visualizations. However, it&amp;rsquo;s sometimes perceived as difficult to get started with or unsuitable for small projects. In this article I will show you how combining D3 and Vue can make your quest for the perfect data visualization a whole lot easier.</p>"><meta data-n-head="ssr" data-hid="ogtitle" property="og:title" content="Vue.js and D3: A Chart Waiting To Happen"><meta data-n-head="ssr" data-hid="twittertitle" property="twitter:title" content="Vue.js and D3: A Chart Waiting To Happen"><meta data-n-head="ssr" data-hid="ogimage" property="og:image" content="https://www.simonwuyts.com/images/share.png"><meta data-n-head="ssr" data-hid="twitterimage" property="twitter:image" content="https://www.simonwuyts.com/images/share.png"><link data-n-head="ssr" rel="icon" type="image/png" href="/favicon.png"><link data-n-head="ssr" rel="stylesheet" type="text/css" href="https://rsms.me/inter/inter.css"><link data-n-head="ssr" rel="alternate" type="application/rss+xml" href="https://www.simonwuyts.com/articles/feed.xml" title="Simon Wuyts - Interaction Designer & Front-end Developer"><link data-n-head="ssr" rel="alternate" type="application/json" href="https://www.simonwuyts.com/articles/feed.json" title="Simon Wuyts - Interaction Designer & Front-end Developer"><link rel="preload" href="/_nuxt/ef6f9da.js" as="script"><link rel="preload" href="/_nuxt/3bad845.js" as="script"><link rel="preload" href="/_nuxt/vendors/app.291a06d.css" as="style"><link rel="preload" href="/_nuxt/7830527.js" as="script"><link rel="preload" href="/_nuxt/app.12ec74d.css" as="style"><link rel="preload" href="/_nuxt/d04c38a.js" as="script"><link rel="preload" href="/_nuxt/pages/articles/_slug.3ff2d76.css" as="style"><link rel="preload" href="/_nuxt/0ef0fba.js" as="script"><link rel="preload" href="/_nuxt/aa4b8e5.js" as="script"><link rel="preload" href="/_nuxt/19c0f32.js" as="script"><link rel="stylesheet" href="/_nuxt/vendors/app.291a06d.css"><link rel="stylesheet" href="/_nuxt/app.12ec74d.css"><link rel="stylesheet" href="/_nuxt/pages/articles/_slug.3ff2d76.css"><link rel="preload" href="/_nuxt/static/1623840608/articles/vuejs-and-d3-a-chart-waiting-to-happen/payload.js" as="script">
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div class="c-main"><svg width="0" height="0" xmlns="http://www.w3.org/2000/svg"><defs><filter id="titleFilter" x="-20%" y="-20%" width="140%" height="140%"><feTurbulence type="fractalNoise" baseFrequency="0.001 0.01" numOctaves="26" seed="1" stitchTiles="stitch" result="turbulence"></feTurbulence><feDisplacementMap in="SourceGraphic" in2="turbulence" scale="20" result="displacementMap" xChannelSelector="R" yChannelSelector="G"></feDisplacementMap><feGaussianBlur in="displacementMap" stdDeviation="1" color-interpolation-filters="sRGB" result="blur"></feGaussianBlur><feColorMatrix in="blur" values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 18 -7" result="contrast"></feColorMatrix><feOffset in="contrast" dy="2"></feOffset></filter></defs></svg> <nav class="c-navigation"><a href="/" class="c-navigation__logo nuxt-link-active"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" preserveAspectRatio="none" class="c-logo"><defs><mask id="logoMask"><circle cx="32" cy="32" r="32" fill="#FFF"></circle> <g stroke="#000" fill="none" stroke-linecap="round" stroke-width="2"><path d="M44.963 26.545c.444-.505.46-1.256-.014-1.743l-5.854-6.037c-1.852-1.91-4.28-2.865-6.708-2.865s-4.856.955-6.708 2.865c-3.705 3.82-3.705 10.015 0 13.835l5.87 6.052c.243.23.548.348.851.348.302 0 .602-.118.838-.361l5.857-6.04 5.867-6.054z" class="c-logo__line"></path> <path d="M19.737 38.155c-.444.505-.46 1.256.014 1.743l5.854 6.037c1.852 1.91 4.28 2.865 6.708 2.865s4.856-.955 6.708-2.865c3.705-3.82 3.705-10.015 0-13.835l-5.87-6.052a1.246 1.246 0 0 0-.851-.348c-.302 0-.602.118-.838.361l-5.857 6.04-5.867 6.054z" class="c-logo__line"></path></g></mask></defs> <circle cx="32" cy="32" r="32" fill="currentColor" mask="url(#logoMask)" class="c-logo__circle"></circle></svg> <span class="sr-only">Home</span></a> <div class="c-navigation__left"><a href="/" class="c-navigation__item">
      Home
    </a> <a href="/work" class="c-navigation__item">
      Work
    </a> <a href="/about" class="c-navigation__item">
      About
    </a> <a href="/articles" class="c-navigation__item c-navigation__item--active">
      Articles
    </a> <a href="/contact" class="c-navigation__item">
      Contact
    </a></div></nav> <div class="c-content"><div class="c-content__center"><div class="c-date enter-fade-in">March 29, 2019</div> <h1 class="c-title enter-fade-up"><div aria-hidden="true" class="c-title__border"><span class="c-title__inner"> Vue.js and D3: A Chart Waiting To Happen </span></div> <div class="c-title__text"><span> Vue.js and D3: A Chart Waiting To Happen </span></div></h1> <ul class="c-tags enter-fade-up enter-delay-1"><li class="c-tags__item"><span class="c-tags__label">
      css
    </span></li><li class="c-tags__item"><span class="c-tags__label">
      d3
    </span></li><li class="c-tags__item"><span class="c-tags__label">
      javascript
    </span></li><li class="c-tags__item"><span class="c-tags__label">
      vuejs
    </span></li></ul> <div class="lead enter-fade-up enter-delay-1"><p>This article is the summary of a talk I gave at the Vue.js Antwerp meetup. For a while now, D3.js has been the go-to JavaScript library for creating custom data visualizations. However, it’s sometimes perceived as difficult to get started with or unsuitable for small projects. In this article I will show you how combining D3 and Vue can make your quest for the perfect data visualization a whole lot easier.</p></div> <div class="enter-fade-up enter-delay-2"><figure><iframe id="talk_frame_506814" class="wide" style="border:0;padding:0;background:0 0" src="//speakerdeck.com/player/cdacbd922db34e72a62bf35dec27d95b" width="710" height="399" frameborder="0" allowfullscreen></iframe></figure>
<p>Right now, I’m working on a project called uman.ai, together with <a href="http://ml6.eu/" target="_blank" rel="noreferrer noopener">ML6</a>, a Ghent-based company specialized in Machine Learning. <a href="http://uman.ai/" target="_blank" rel="noreferrer noopener">Uman.ai</a> explores new ways of gaining insight in talents and skills within organizations with the help of Artificial Intelligence. I took on the challenge to find a good interactive visualization for this model.</p>
<p>After making some first rough sketches, I started exploring well-known existing libraries like <strong>Chart.js</strong> and <strong>Highcharts</strong>. However, none of them turned out to be a good fit for this very specific situation. And this is where <a href="http://d3js.org/" target="_blank" rel="noreferrer noopener"> <strong>D3.js</strong> </a> got in and I first got the idea for this talk.</p>
<h2>D3.js</h2>
<p>D3 had always felt kind of unfeasable for me. Most of the demo projects I saw were impressive, but they also looked pretty hard to recreate. For a long time I was convinced D3 was only suited for large and complex projects. I turned out to be wrong.</p>
<p>Before diving into some code, let me quickly give you an overview of what D3 exactly is. D3 is short for <em>Data Driven Documents</em> and calls itself <em>“a JavaScript library for manipulating documents based on data”</em>. D3 doesn’t include any pre-built visualizations, but provides you with a lot of useful utilities. This list of utilities might look a little intimidating at first, but we will only need a few.</p>
<p>D3 has a jQuery-like syntax when it comes to defining templates:</p>
<pre><code class="language-javascript">// Add a  element for every data point
const leaf = svg.selectAll('g').data(circles)

// Append a styled  to every  element
leaf
  .append('circle')
  .attr('id', d => d.data.id)
  .attr('r', d => d.r)
  .attr('fill-opacity', 0.7)
  .attr('fill', d => d.data.color)
</code></pre>
<p>This might work well most of the time, but it feels a little counter-intuitive when you’re already using Vue.js in your project. With Vue.js, you’re probably used to template code that has a close connection the actual HTML result. In the next part of this article, I will show you how to replace the rendering part in the D3 workflow with Vue’s templating system we’re already using.</p>
<h2>Let's write some code</h2>
<p>For the sake of simplicity, I will use the example of a flower shop here. Let’s start with Vue component with nothing more than an empty SVG element and some base data to start from.</p>
<pre><code class="language-markup">&lt;template>
  &lt;svg width="500" height="500">
  &lt;/svg>
&lt;/template>

&lt;script>
export default {
  data() {
    return {
      flowers: [
        {
          name: 'Roses',
          amount: 25,
          color: '#cc2936'
        },
        {
          name: 'Tulips',
          amount: 40,
          color: '#f2c640'
        },
        {
          name: 'Daisies',
          amount: 15,
          color: '#2a93d4'
        },
        {
          name: 'Narcissuses',
          amount: 9,
          color: '#F7AD0A'
        }
      ]
    }
  }
}
&lt;/script></code></pre>
<p>We now need to find out the best way to:</p>
<ol>
<li>Render a circle for every type of flower</li>
<li>Size the circles according to the amount of flowers</li>
<li>Give each circle the right color</li>
<li>Find the best position for each circle</li>
</ol>
<p>This last one is the trickiest one, since we will need some kind of algorithm to calculate the most optimal positions. The algorithm we need is called <a href="https://en.wikipedia.org/wiki/Circle_packing" target="_blank" rel="noreferrer noopener">Circle Packing</a>. One of the layout utilities D3 offers is the <strong>pack layout</strong>. It takes a data set (which is called a hierarchy here) and outputs a set of packed circles. Exactly what we need.</p>
<p>However, for D3 to correctly parse our flower data, we have to pass it through in a specific format. Let’s use a computed property to transform our original state:</p>
<pre><code class="language-markup">&lt;template>
  &lt;svg width="500" height="500">
  &lt;/svg>
&lt;/template>

&lt;script>
export default {
  data() {
    return {
      flowers: [
        {
          name: 'Roses',
          amount: 25,
          color: '#cc2936'
        },
        {
          name: 'Tulips',
          amount: 40,
          color: '#f2c640'
        },
        {
          name: 'Daisies',
          amount: 15,
          color: '#2a93d4'
        },
        {
          name: 'Narcissuses',
          amount: 9,
          color: '#F7AD0A'
        }
      ]
    }
  },
  computed: {
    transformedFlowerData() {
      return {
        name: 'Top Level',
        children: this.flowers.map(flower => ({
          ...flower,
          parent: 'Top Level'
        }))
      }
    }
  }
}
&lt;/script></code></pre>
<p>Right now, we have everything in place to start using some of D3’s magic. Let’s import only the parts we need and let D3 do its calculations.</p>
<pre><code class="language-markup">&lt;template>
  &lt;svg width="500" height="500">
  &lt;/svg>
&lt;/template>

&lt;script>
import { hierarchy, pack } from 'd3-hierarchy'
export default {
  data() {
    return {
      flowers: [
        {
          name: 'Roses',
          amount: 25,
          color: '#cc2936'
        },
        {
          name: 'Tulips',
          amount: 40,
          color: '#f2c640'
        },
        {
          name: 'Daisies',
          amount: 15,
          color: '#2a93d4'
        },
        {
          name: 'Narcissuses',
          amount: 9,
          color: '#F7AD0A'
        }
      ]
    }
  },
  computed: {
    transformedFlowerData() {
      return {
        name: 'Top Level',
        children: this.flowers.map(flower => ({
          ...flower,
          parent: 'Top Level'
        }))
      }
    },

    layoutData() {
      // Generate a D3 hierarchy
      const rootHierarchy =
        hierarchy(this.transformedFlowerData)
        .sum(d => d.size)
        .sort((a, b) => {
          return b.value - a.value
        })
      // Pack the circles inside the viewbox
      return pack()
        .size([500, 500])
        .padding(10)(rootHierarchy)
    }
  }
}
&lt;/script></code></pre>
<p>Finally, we can use the layoutData property to compose a template like we would in any other Vue component. Here we use the calculated layout values to add some labels, colors, transforms and sizes.</p>
<pre><code class="language-markup">&lt;template>
  &lt;svg width="500" height="500">
    &lt;g
      class="flower"
      v-for="flower in layoutData.children"
      :key="flower.data.name"
      :style="{
        transform: `translate(${flower.x}px, ${flower.y}px)`
      }"
    >
      &lt;circle
        class="flower__circle"
        :r="flower.r"
        :fill="flower.data.color"
      />
      &lt;text class="flower__label”>
        {{ flower.data.name }}
      &lt;/text>
    &lt;/g>
  &lt;/svg>
&lt;/template></code></pre>
<p>Adding a simple CSS transition will make value changes animate smoothly:</p>
<pre><code class="language-css">.flower {
  transition: transform 0.1s ease-in-out;
}

.flower__circle {
  transition: r 0.1s ease-in-out;
}</code></pre>
<p>The chart now looks just as we intended. You can now expand your component functionality as you like, by adding some controls to alter the state for example:</p>
<figure><iframe class="wide" style="height:500px;border:0;border-radius:4px;overflow:hidden" title="Vue.js and D3" src="https://codesandbox.io/embed/6lvzwvpjnn?fontsize=14" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin"></iframe></figure>
<h2>Conclusion</h2>
<p>Nothing is perfect of course, and there are three <strong>caveats</strong> to this technique you should know about.</p>
<ol>
<li>For big sets of data, it gets more and more difficult to keep a good performance. Especially when using a lot of animations. However, this also applies when you’re using D3 without Vue.js.</li>
<li>For simple and well-known chart formats, it might still be easier to just use something like Chart.js or Highcharts.</li>
<li>Some more complex features of D3, like gravity-based animations, spring values or drag and drop-interactions might be a little harder to integrate this way. However, most of them will just work fine.</li>
</ol>
<p>Luckily, this technique also has a lot of <strong>advantages</strong>:</p>
<ol>
<li>Your code stays very close to the actual result.</li>
<li>This makes experimenting easy and fast.</li>
<li>Your code will blend very nicely with your existing Vue.js code.</li>
<li>Your code will be very approachable. Even someone who only knows HTML and CSS will be able to make adjustments.</li>
<li>Since you can also use Vue for mobile apps (with for example <a href="https://nativescript.org/" target="_blank" rel="noreferrer noopener">NativeScript</a>or <a href="https://weex.apache.org/" target="_blank" rel="noreferrer noopener">Weex</a>) you can use D3 on virtually any platform that supports Vue.</li>
</ol>
<p>I really hope next time your project needs some kind of custom out-of-the-box chart, you’ll think of this talk and give D3 a chance. The rest will be up to your imagination.</p></div> <div class="c-social"><h3 class="c-social__title"><!----> <div class="c-social__secondary">
      Find me online or
      <a href="/contact">get in touch</a></div></h3> <ul class="c-social-links"><li class="c-social-links__item"><a href="https://www.twitter.com/simonwuyts" target="_blank" rel="noopener"><svg width="24" height="24" viewBox="0 0 24 24" class="c-social-links__icon"><path d="M22.4592,6.01238 C21.6896,6.35373 20.8624,6.58442 19.9944,6.68815 C20.8803,6.15701 21.5609,5.31598 21.8813,4.31378 C21.052,4.80564 20.1336,5.16278 19.156,5.3552 C18.3732,4.52112 17.2579,4 16.0235,4 C13.6534,4 11.7317,5.92147 11.7317,8.29155 C11.7317,8.6279 11.7697,8.95546 11.8429,9.2696 C8.2761,9.0906 5.11376,7.38203 2.9971,4.78551 C2.62766,5.41935 2.41602,6.15656 2.41602,6.94309 C2.41602,8.43204 3.17365,9.74563 4.32524,10.5153 C3.6218,10.4929 2.95997,10.2999 2.3814,9.97846 C2.38099,9.99639 2.38099,10.0143 2.38099,10.0324 C2.38099,12.1118 3.86034,13.8463 5.8236,14.2406 C5.4635,14.3387 5.08435,14.3912 4.69295,14.3912 C4.41641,14.3912 4.14756,14.3642 3.88547,14.3142 C4.43162,16.0191 6.01654,17.26 7.89455,17.2945 C6.42577,18.4457 4.57528,19.1318 2.56454,19.1318 C2.21813,19.1318 1.87652,19.1114 1.54078,19.0717 C3.44004,20.2894 5.69592,21 8.11951,21 C16.0134,21 20.3302,14.4605 20.3302,8.78918 C20.3302,8.60314 20.326,8.41805 20.3177,8.23395 C21.1563,7.62886 21.8839,6.87302 22.4592,6.01238 Z"></path></svg> <span class="c-social-links__label">Twitter</span></a></li> <li class="c-social-links__item"><a href="https://medium.com/@simonwuyts" target="_blank" rel="noopener"><svg width="24" height="24" viewBox="0 0 24 24" class="c-social-links__icon"><path d="M21.9288,6.61625 L15.8894,16.4716 L11.5719,9.42603 L15.0087,3.84105 C15.1668,3.58425 15.4947,3.46648 15.7792,3.54857 L21.9288,6.61625 Z M22,19.7818 C22,20.3517 21.504,20.5657 20.8923,20.2599 L16.1836,17.9055 L22,8.41393 L22,19.7818 Z M8.98814,19.9374 C8.98814,20.5049 8.57267,20.7616 8.0651,20.5078 L2.55379,17.7572 C2.24918,17.6049 1.99997,17.2017 1.99997,16.8611 L1.99997,4.1393 C1.99997,3.68523 2.33231,3.47987 2.7384,3.68294 L8.70478,6.66122 L8.98814,7.12362 L8.98814,19.9374 Z M15.2858,17.4566 L10,14.8137 L10,8.81372 L15.2858,17.4566 Z"></path></svg> <span class="c-social-links__label">Medium</span></a></li> <li class="c-social-links__item"><a href="https://www.github.com/simonwuyts" target="_blank" rel="noopener"><svg width="24" height="24" viewBox="0 0 24 24" class="c-social-links__icon"><path d="M11.9991,2 C6.47774,2 2.00001,6.47712 2.00001,12.0006 C2.00001,16.4184 4.86504,20.1665 8.83877,21.489 C9.33909,21.5807 9.52142,21.272 9.52142,21.007 C9.52142,20.7696 9.51282,20.1407 9.50791,19.3062 C6.72636,19.9105 6.13948,17.9657 6.13948,17.9657 C5.68459,16.8105 5.02895,16.5029 5.02895,16.5029 C4.121,15.8824 5.09771,15.895 5.09771,15.895 C6.10143,15.9657 6.62936,16.9256 6.62936,16.9256 C7.52135,18.4537 8.97014,18.0125 9.53984,17.7565 C9.63069,17.1102 9.88914,16.6696 10.1746,16.4196 C7.95415,16.1672 5.61952,15.3093 5.61952,11.4773 C5.61952,10.3856 6.00934,9.49292 6.64902,8.79388 C6.54588,8.54089 6.20271,7.52417 6.74723,6.14739 C6.74723,6.14739 7.58643,5.87851 9.49686,7.17252 C10.2943,6.95073 11.1501,6.8398 12.0003,6.83594 C12.8499,6.8398 13.7051,6.95073 14.5038,7.17252 C16.413,5.87851 17.2509,6.14739 17.2509,6.14739 C17.7967,7.52417 17.4535,8.54089 17.351,8.79388 C17.9919,9.49292 18.3787,10.3856 18.3787,11.4773 C18.3787,15.3189 16.0403,16.1642 13.8131,16.4118 C14.1717,16.7205 14.4915,17.3308 14.4915,18.2637 C14.4915,19.6005 14.4792,20.6791 14.4792,21.007 C14.4792,21.2744 14.6597,21.5855 15.1668,21.4878 C19.1374,20.1629 22,16.4172 22,12.0006 C22,6.47712 17.5223,2 11.9991,2 Z"></path></svg> <span class="c-social-links__label">Github</span></a></li></ul></div></div></div></div></div></div><script>window.__NUXT__={staticAssetsBase:"/_nuxt/static/1623840608",layout:"default",error:null,serverRendered:!0,routePath:"/articles/vuejs-and-d3-a-chart-waiting-to-happen",config:{}}</script><script src="/_nuxt/ef6f9da.js" defer></script><script src="/_nuxt/0ef0fba.js" defer></script><script src="/_nuxt/aa4b8e5.js" defer></script><script src="/_nuxt/19c0f32.js" defer></script><script src="/_nuxt/3bad845.js" defer></script><script src="/_nuxt/7830527.js" defer></script><script src="/_nuxt/d04c38a.js" defer></script>
  </body>
</html>
